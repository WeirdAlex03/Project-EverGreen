<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta http-equiv="Cache-control" content="no-cache, no-store, must-revalidate">
    <title>Project Evergreen</title>
     <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body onload="start()">
    <header>
        <h1>Project Evergreen</h1>
        <nav>
            <a href="#about">About</a>
            <a href="#contact">Contact</a>
        </nav>
    </header>

    <main>
        <section id="about">
            <h2>About Us</h2>
            <p>Project Evergreen is dedicated to promoting sustainability and environmental awareness. Join our club to make a positive impact on our planet!</p>
        </section>

        <section id="contact">
            <h2>Contact Us</h2>
            <p>If you have any questions or want to join our club, feel free to reach out!</p>
            <p>Join our Discord: <a href="https://discord.com/invite/QMHjt65z7a">https://discord.com/invite/QMHjt65z7a</a></p>
        </section>
    </main>
    <div class="login">
        Registration:
        <form action="/register" method="post" enctype="application/x-www-form-urlencoded">
            <label>UB Email:
                <input type="email" name="email"/>
            </label>
            <br/>
            <label>Password:&nbsp;
                <input type="password" name="password">
            </label>
            <br/>
            <label>Confirm Password:&nbsp;
                <input type="password" name="confirm password">
            </label>
            <input type="submit" value="Post">
            <br/>
            <br/>
        </form>

        Login:
        <form action="/login" method="post" enctype="application/x-www-form-urlencoded">
            <label>UB Email:
                <input type="email" name="email"/>
            </label>
            <br/>
            <label>Password:&nbsp;
                <input type="password" name="password">
            </label>
            <input type="submit" value="Post">
            <br/>
        </form>
    </div>

    <div class="login">
        Registration:
        <form action="/register" method="post" enctype="application/x-www-form-urlencoded">
            {% csrf_token %}
            <label>UB Email:
                <input type="email" id="email" name="email"/>
            </label>
            <br/>
            <label>Password:&nbsp;
                <input type="password" id="password" name="password">

            </label>

            <button type="button" onclick="validate()">Validate Registration</button>

            <br/>
            <label>Confirm Password:&nbsp;
                <input type="password" name="confirm_password">
            </label>
            <input type="submit" value="Post">
            <br/>
            <br/>
        </form>

        <div id="passwordMessage"></div>



        Login:
        <form action="/login" method="post" enctype="application/x-www-form-urlencoded">
            {% csrf_token %}
            <label>UB Email:
                <input type="email" name="email"/>
            </label>
            <br/>
            <label>Password:&nbsp;
                <input type="password" name="password">
            </label>
            <input type="submit" value="Post">
            <br/>
        </form>
    </div>

    <script>
    var validateUrl = "{% url 'validate' %}";

    async function validate() {


        const password = document.getElementById("password").value;
        const email = document.getElementById("email").value;
        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;

         const response = await fetch("{% url 'validate' %}", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded",
                        "X-CSRFToken": csrfToken,

                    },

                    body: `password=${encodeURIComponent(password)}&email=${encodeURIComponent(email)}`
                });


        const result = await response.json();


    const messageDiv = document.getElementById("passwordMessage");
    let out = [];

    if (String(result.valid_pass) === "False") {
        out.push("PASSWORDS MUST BE 12 OR GREATER IN LENGTH");
    }
    if (String(result.valid_email) === "False") {
        out.push("ONLY VALID UB EMAILS ACCEPTED");
    }

    if (out.length === 0) {
        messageDiv.style.color = "green";
        messageDiv.innerHTML = "VALID EMAIL AND PASS";
    } else {
        messageDiv.style.color = "red";
        messageDiv.innerHTML = out.join("<br>");
    }
}
</script>


    <script src="{% static 'js/functions.js' %}"></script>
    <img src="{% static 'images/plant.jpg' %}" alt="A logo pic of a plant">
</body>
</html>